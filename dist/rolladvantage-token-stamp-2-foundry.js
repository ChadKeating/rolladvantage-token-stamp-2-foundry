!function(){"use strict";Hooks.on("ready",()=>{const t=`renderTokenConfig${"pf1"===game.system.id?"PF":""}`;Hooks.on(t,e.render),e.createDirectory()});const e={getSavePath:()=>"worlds/"+game.world.name+"/RollAdvantageTokens",createDirectory:async()=>{var t=e.getSavePath(),a=await FilePicker.browse("data",t);console.dir(a),null!=a&&a.target==t||FilePicker.createDirectory("data",t)},render:async(e,a)=>{var n=a.find('.tab[data-tab="image"]').find(".form-group .form-fields").first();n.append("<button type='button' id='ra-ts2-open-button' title='Create Token' tabindex='-1'><img src='https://rolladvantage.com/assets/images/logo/default.png' /></button>"),n.find("#ra-ts2-open-button").click(e=>{e.preventDefault();const n=new t;n.render(!0),n.exportInputBox=a.find("input.image")})}};class t extends Application{static get defaultOptions(){const e=super.defaultOptions;return e.template="/modules/rolladvantage-token-stamp-2-foundry/templates/wrapper-template.html",e.resizable=!1,e.width=1263,e.height=937,e.classes=["ts2-wrapper"],e.title="Token Stamp 2 - RollAdvantage.com",e}static createTokenFile(e,t){for(var a=atob(e.split(",")[1]),n=[],o=0;o<a.length;o++)n.push(a.charCodeAt(o));var r=new Blob([new Uint8Array(n)],{type:"image/png"});return new File([r],t)}static async uploadToken(a,n){var o=t.createTokenFile(a,n);return await FilePicker.upload("data",e.getSavePath(),o,{})}activateListeners(e){super.activateListeners(e);var a=this;e.on("click","#ra-ts2-import-token-button",()=>{var e=n=>{"https://rolladvantage.com"==n.origin&&(window.removeEventListener("message",e,!1),t.uploadToken(n.data.stampData,game.userId+"-"+Math.floor(1e3*Math.random())+".png").then(e=>{a.exportInputBox[0].value=e.path,a.close()}))};window.addEventListener("message",e,!1),document.getElementById("ra-ts2-iframe").contentWindow.postMessage({action:"getFoundryData"},"*")})}}}();
//# sourceMappingURL=rolladvantage-token-stamp-2-foundry.js.map
